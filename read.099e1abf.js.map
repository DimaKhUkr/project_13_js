{"mappings":"AAAA,MAGMA,EAAWC,SAASC,cAAc,SAiFzB,SAANC,EAAeC,GAEtB,MAAO,6FAGuBA,+H,CAUZ,SAAXC,EAAeC,GACtB,MAAMC,EAAQD,EAAKE,SAASC,KAGtBC,EACgB,IAApBJ,EAAKK,WACD,4BAA4BL,EAAKK,WAAW,GAAGC,MAC/C,mCAEAC,IAAEA,EAAGC,aAAEA,EAAYC,SAAEA,EAAQC,SAAEA,EAAQC,QAAEA,GAAYX,EAE3D,MAAO,6EAGeI,mHAEyBI,2FAGhBD,kHAGYN,2DAE7BQ,EAASG,OAAS,IACdH,EAASI,UAAU,EAAG,KAAO,MAC7BJ,sGAGyB,IAAIK,KACjCJ,GACAK,mFACsCJ,mJ,CAYrCK,eAAFC,EAAYC,GACzB,IACE,aAAaC,MACX,qEAA0BD,gDAC1BE,MAAKC,GAAQA,EAAKC,Q,CACpB,MAAOC,GACPC,QAAQD,MAAMA,E,GAtIE,WAClB,GAAiC,IAA7B7B,EAAS+B,SAASb,OAAc,CAClCY,QAAQE,IAAI,SACZ,MAAMC,EACJ,6FACFjC,EAASkC,UAAYD,C,CAEvBH,QAAQE,IAAI,Y,CAhBdG,GA2CgBb,iBACd,IAAIc,EAAa,GACbH,EAAS,GACTI,EAAY,GAChBrC,EAASkC,UAAY,GACrB,IAAK,IAAII,EAAI,EAAGA,EAAIC,aAAarB,OAAQoB,GAAK,EAAG,CAC/C,IAAIlC,EAAamC,aAAaC,IAAIF,GAElC,GADe,wBACDG,KAAKrC,GAAa,CAGVgC,GAAMjC,EAAeC,GACzC0B,QAAQE,IAAI5B,GAIZ,MAAMsC,EAASC,KAAKC,MAAML,aAAaM,QAAQzC,IAC/C0B,QAAQE,IAAIU,GACZ,IAAK,IAAIJ,EAAI,EAAGA,EAAII,EAAOxB,OAAQoB,GAAK,EAAG,CACzC,IAAId,EAAQkB,EAAOJ,GACnBR,QAAQE,IAAIR,GACZ,MACMlB,SADaiB,EAAYC,IACbsB,SAASC,KAE3Bd,GAAkB5B,EAAeC,EAAK,G,CAGxC+B,EAAYD,EAAaH,C,EAK3BjC,EAASgD,mBAAmB,YAAaX,E,CAtE7CY","sources":["src/js/read-markup.js"],"sourcesContent":["const API_KEY = 'u59IF6VhLyuj5qt5wMVcLGGSUKapZTsn';\nconst URL_SEARCH = 'https://api.nytimes.com/svc/search/v2/articlesearch.json';\n\nconst readList = document.querySelector('.read');\n\n\nisReadEmpty();\n// getReadKeys();\n// testMarkup();\n// testMarkupWithFilter();\n// getReadNews(100000008677561);\ncreateReadPage();\n// \"nyt://article/59fa3c31-ddd7-562c-ab32-e202a892d697\"\n\n// Для порожньої сторінки\nfunction isReadEmpty() {\n  if (readList.children.length === 0) {\n    console.log('empty');\n    const markup =\n      '<li class=\"read-item-empty\"><h2>Nothing read yet</h2><div class=\"read-empty\"></div></li > ';\n    readList.innerHTML = markup;\n  }\n  console.log('Not empty');\n}\n\nfunction testMarkup() {\n  // Отримуємо всі ключі з localStorage\n  const keys = Object.keys(localStorage);\n\n  // Фільтруємо ключі за заданим форматом дати\n  const dateRegex = /^\\d{2}\\/\\d{2}\\/\\d{4}$/;\n  const filteredKeys = keys.filter(key => dateRegex.test(key));\n\n  // Створюємо розмітку для кожного ключа та його значення\n  const markup = filteredKeys\n    .map(key => {\n      const queries = JSON.parse(localStorage.getItem(key));\n      console.log(queries);\n\n      const paragraphs = queries.map(item => `<p>${item}</p>`).join('');\n      return `<h2>${key}</h2>${paragraphs}`;\n    })\n    .join('');\n\n  // Додаємо розмітку в тег body\n  readList.innerHTML = markup;\n}\n\n// Формуємо сторінку\nasync function createReadPage() {\n  let markupList = '';\n  let markup = '';\n  let markupAll = '';\n  readList.innerHTML = '';\n  for (let i = 0; i < localStorage.length; i += 1) {\n    let storageKey = localStorage.key(i);\n    const dateRegex = /^\\d{2}\\/\\d{2}\\/\\d{4}$/;\n    if (dateRegex.test(storageKey)) {\n      // малюємо першу розмітку\n      \n      markupList = markupList + createReadList(storageKey);\n      console.log(storageKey);\n      // const value = localStorage.getItem(storageKey)\n      // console.log(value);\n\n      const values = JSON.parse(localStorage.getItem(storageKey));\n      console.log(values);\n      for (let i = 0; i < values.length; i += 1) {\n        let query = values[i];\n        console.log(query);\n        const data = await getReadNews(query);\n        const news = data.response.docs;\n        // console.log(news);\n        markup = markup + createReadNews(news[0]);\n        \n      }\n      markupAll = markupList + markup\n      // const readItem = document.querySelector('.read');\n      // readItem.insertAdjacentHTML('beforeend', markup);\n    }\n    \n  } readList.insertAdjacentHTML('beforeend', markupAll);\n}\n// Формуємо галерею\nfunction createReadList(storageKey) {\n  // const dateTitle = storageKey;\n  return `\n  <li class=\"read-item\">\n      <div class=\"read-title\">\n        <h2 class=\"read-date\">${storageKey}</h2>\n        <div class=\"read-arrow\"></div>\n      </div>\n      <ul class=\"read-gallery\">\n      </ul>\n  </li>\n        `;\n}\n\n// Формуємо картку новини\nfunction createReadNews(news) {\n  const title = news.headline.main;\n  const isFavorite = true;\n\n  const photoUrl =\n    news.multimedia !== 0\n      ? `https://static01.nyt.com/${news.multimedia[0].url}`\n      : 'https://via.placeholder.com/400';\n\n  const { _id, section_name, abstract, pub_date, web_url } = news;\n\n  return `\n         <li>\n          <div class=\"news-card\">\n            <img src=\"${photoUrl}\" alt=\"заглушка\" />\n            <div class=\"news-card__info\">\n              <div class=\"news-card__category\">${section_name}</div>\n              <button class=\"news-card__favorite-btn ${\n                isFavorite ? 'active_btn' : ''\n              }\" data-news-id=\"${_id}\">\n                ${isFavorite ? 'Remove from Favorite' : 'Add to Favorite'}\n              </button>\n              <h2 class=\"news-card__title\">${title}</h2>\n              <p class=\"news-card__description\">${\n                abstract.length > 100\n                  ? abstract.substring(0, 100) + '...'\n                  : abstract\n              }</p>\n              <div class=\"news-card__date-div\">\n              <div class=\"news-card__date\">${new Date(\n                pub_date\n              ).toLocaleDateString()}</div>\n              <a class=\"news-card__read-more\" href=\"${web_url}\" target=\"_blank\">Read more</a>\n              </div>\n            </div>\n          </div>\n         </div>\n      </div>\n    </li>\n         `;\n}\n\n// Відправляємо запит\n\nasync function getReadNews(query) {\n  try {\n    return await fetch(\n      `${URL_SEARCH}?fq=_id:(\"${query}\")&api-key=${API_KEY}`\n    ).then(resp => resp.json());\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// Перевірка наявності в локал сторідж ключів потрібного формата\n// const keys = Object.keys(localStorage);\n\n// keys.filter(key => /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(key)).forEach(key => {\n//   const value = localStorage.getItem(key);\n//   console.log(`Значення для ключа ${key}: ${value}`);\n// });\n\n// function getReadKeys() {\n//   const keys = Object.keys(localStorage);\n//   keys.filter(key => /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(key)).forEach(key => {\n//   const value = localStorage.getItem(key);\n//   console.log(`Значення для ключа ${key}: ${value}`);\n// });\n// };\n\n// ===============================================\n// function testMarcup() {\n// // Отримуємо всі ключі з localStorage\n// const keys = Object.keys(localStorage);\n\n// // Фільтруємо ключі за заданим форматом дати\n// const dateRegex = /^\\d{2}\\/\\d{2}\\/\\d{4}$/;\n// const filteredKeys = keys.filter(key => dateRegex.test(key));\n\n// // Створюємо розмітку для кожного ключа та його значення\n// const markup = filteredKeys.map(key => {\n//   const value = JSON.parse(localStorage.getItem(key));\n//   const paragraphs = value.map(item => `<p>${item}</p>`).join('');\n//   return `<h2>${key}</h2>${paragraphs}`;\n// }).join('');\n\n// // Додаємо розмітку в тег body\n// readList.innerHTML = markup;\n// };\n\n// =========================З перевіркою на унікальність=========\nfunction testMarkupWithFilter() {\n  // Отримуємо всі ключі з localStorage\n  const keys = Object.keys(localStorage);\n\n  // Фільтруємо ключі за заданим форматом дати\n  const dateRegex = /^\\d{2}\\/\\d{2}\\/\\d{4}$/;\n  const filteredKeys = keys.filter(key => dateRegex.test(key));\n\n  // Об'єднуємо значення з однаковими датами, зберігаючи тільки унікальні значення\n  const data = {};\n  filteredKeys.forEach(key => {\n    const value = JSON.parse(localStorage.getItem(key));\n    value.forEach(item => {\n      if (data[item]) {\n        const existingDate = Object.keys(data[item])[0];\n        const currentDate = key;\n        if (new Date(currentDate) > new Date(existingDate)) {\n          data[item] = { [currentDate]: true };\n        }\n      } else {\n        data[item] = { [key]: true };\n      }\n    });\n  });\n\n  // Створюємо розмітку для кожного ключа та його значення\n  const markup = Object.keys(data)\n    .map(item => {\n      const dates = Object.keys(data[item]);\n      const paragraphs = `<p>${item}</p>`.repeat(dates.length);\n      return `<h2>${dates[0]}</h2>${paragraphs}`;\n    })\n    .join('');\n\n  // Додаємо розмітку в тег body\n  readList.innerHTML = markup;\n}\n// ==================================================\n\nfunction testMarkupWithEnotherFilter() {\n  // Отримуємо всі ключі з localStorage\n  const keys = Object.keys(localStorage);\n\n  // Фільтруємо ключі за заданим форматом дати\n  const dateRegex = /^\\d{2}\\/\\d{2}\\/\\d{4}$/;\n  const filteredKeys = keys.filter(key => dateRegex.test(key));\n\n  // Створюємо об'єкт, де ключами є унікальні значення з localStorage, а значеннями є масиви ключів, які містять ці значення\n  const uniqueValues = {};\n  filteredKeys.forEach(key => {\n    const value = JSON.parse(localStorage.getItem(key));\n    value.forEach(item => {\n      if (!uniqueValues[item]) {\n        uniqueValues[item] = [];\n      }\n      uniqueValues[item].push(key);\n    });\n  });\n\n  // Створюємо розмітку для кожного ключа та його значення\n  const markup = filteredKeys\n    .map(key => {\n      const value = JSON.parse(localStorage.getItem(key));\n      const paragraphs = value\n        .filter(item => uniqueValues[item].indexOf(key) === 0) // Фільтруємо унікальні значення для кожного ключа\n        .map(item => `<p>${item}</p>`)\n        .join('');\n      return `<h2>${key}</h2>${paragraphs}`;\n    })\n    .join('');\n\n  // Додаємо розмітку в тег body\n  readList.innerHTML = markup;\n}\n"],"names":["$a6108ac09bc68599$var$readList","document","querySelector","$a6108ac09bc68599$var$createReadList","storageKey","$a6108ac09bc68599$var$createReadNews","news","title","headline","main","photoUrl","multimedia","url","_id","section_name","abstract","pub_date","web_url","length","substring","Date","toLocaleDateString","async","$a6108ac09bc68599$var$getReadNews","query","fetch","then","resp","json","error","console","children","log","markup","innerHTML","$a6108ac09bc68599$var$isReadEmpty","markupList","markupAll","i","localStorage","key","test","values","JSON","parse","getItem","response","docs","insertAdjacentHTML","$a6108ac09bc68599$var$createReadPage"],"version":3,"file":"read.099e1abf.js.map"}