{"mappings":"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","sources":["src/js/local-storage.js","src/js/favorites.js"],"sourcesContent":["const API_KEY = 'u59IF6VhLyuj5qt5wMVcLGGSUKapZTsn';\nconst URL_SEARCH = 'https://api.nytimes.com/svc/search/v2/articlesearch.json';\nconst STOR_KEY = 'favorites';\n\nfunction toggleFavoriteNews(event) {\n  const button = event.target;\n  const newsId = button.dataset.newsId;\n\n  if (button.textContent.includes('Add')) {\n    button.textContent = 'Remove from Favorite';\n    button.classList.add('active_btn');\n    addNewsToLocalStorage(newsId);\n  } else {\n    console.log('delete from fav');\n    button.textContent = 'Add to Favorite';\n    button.classList.remove('active_btn');\n    deleteNewsFromLocalStorage(newsId);\n  }\n}\n\n// ----- функція додавання новини в ЛС\nasync function addNewsToLocalStorage(newsId) {\n\n  // -----  перевіряємо чи додається \"погана\" новина\n  if (newsId.includes('video') || newsId.includes('slideshow')) {\n    return console.log('wrong news');\n  }\n\n  // ----- запит до бекенду\n  const data = await getFavoriteNews(newsId);\n  const news = data.response.docs[0];\n  // console.log('news=', news);\n\n  // ----- змінні для об'єкту з новиною\n  const { _id, section_name, abstract, pub_date, web_url } = news;\n  const title = news.headline.main;\n  const photoUrl =\n    news.multimedia.length === 0\n      ? 'https://user-images.githubusercontent.com/110947394/222411348-dc3ba506-91e5-4318-9a9e-89fcf1a764a8.jpg'\n      : `https://static01.nyt.com/${news.multimedia[0].url}`;\n\n  // ----- запис об'єку новини в ЛС\n  const newsObject = {\n    _id,\n    section_name,\n    abstract,\n    pub_date,\n    web_url,\n    photoUrl,\n    title,\n  };\n\n  const currentData = loadFromStorage(STOR_KEY);\n  if (currentData === undefined) {\n    saveToStorage(STOR_KEY, [newsObject]);\n  } else {\n    currentData.push(newsObject);\n    saveToStorage(STOR_KEY, currentData);\n  }\n}\n\n// ----- функція видалення новини з ЛС\nfunction deleteNewsFromLocalStorage(newsId) {\n  const currentData = loadFromStorage(STOR_KEY);\n  const newsIndex = currentData.findIndex(news => news._id === newsId);\n  currentData.splice(newsIndex, 1);\n  saveToStorage(STOR_KEY, currentData);\n}\n\n// ----- функція запису даних в ЛС, пара ключ/значення\nfunction saveToStorage(key, value) {\n  try {\n    const data = JSON.stringify(value);\n    localStorage.setItem(key, data);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// ----- функція завантаження даних з ЛС по ключу або und якщо не існує\nfunction loadFromStorage(key) {\n  try {\n    const localData = localStorage.getItem(key);\n    return localData === null ? undefined : JSON.parse(localData);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// ----- функція запиту на бекенд\nasync function getFavoriteNews(query) {\n  try {\n    return await fetch(\n      `${URL_SEARCH}?fq=_id:(\"${query}\")&api-key=${API_KEY}`\n    ).then(resp => resp.json());\n    //   .then(res => console.log(res))\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// функція перевірки у вибраному при відмальовці картки новини\nfunction isNewsInFavorites(newsId) {\n  const currentData = loadFromStorage(STOR_KEY);\n  const isFavorit = currentData.some(news => news._id === newsId);\n  return isFavorit;\n}\n\nexport { loadFromStorage, toggleFavoriteNews, isNewsInFavorites };\n","import { loadFromStorage, toggleFavoriteNews } from './local-storage';\n\nconst STOR_KEY_FAV = 'favorites';\n\nconst placeForFavNews = document.getElementById('favorite-articles');\n\ncreateFavoritePage();\n\nplaceForFavNews.addEventListener('click', event => {\n  const button = event.target.closest('.news-card__favorite-btn');\n  if (button !== null) {\n    toggleFavoriteNews(event);\n    createFavoritePage();\n  }\n});\n\n// ----- функція створення сторінки обраних новин\nfunction createFavoritePage() {\n  let markup = '';\n\n  placeForFavNews.innerHTML = '';\n\n  const currentData = loadFromStorage(STOR_KEY_FAV);\n  if (currentData !== undefined) { \n  currentData.forEach(news => (markup = markup + createFavoriteNewsCard(news)));\n  }\n  \n  if (markup === '' || currentData === undefined) markup = noNewsInFavorite();\n\n  placeForFavNews.insertAdjacentHTML('beforeend', markup);\n}\n\n// ----- функція картинки коли нема вибраних новин\nfunction noNewsInFavorite() {\n  return `\n  <div class=\"favorite-news__none\">\n    <p class=\"favorite-news__none__title\">We haven't found news on this page</p>\n  </div>`;\n}\n\n// ----- функція створення картки новини\nfunction createFavoriteNewsCard(news) {\n\n  const { _id, section_name, abstract, pub_date, web_url, photoUrl, title } =\n    news;\n  return `\n            <div class=\"news-card\">\n              <img src=\"${photoUrl}\" alt=\"заглушка\" />\n              <div class=\"news-card__info\">\n                <div class=\"news-card__category\">${section_name}</div>\n                <button class=\"news-card__favorite-btn active_btn\"\n                data-news-id=\"${_id}\">\n                  'Remove from Favorite'\n                </button>\n                <h2 class=\"news-card__title\">${title}</h2>\n                <p class=\"news-card__description\">${\n                  abstract.length > 100\n                    ? abstract.substring(0, 100) + '...'\n                    : abstract\n                }</p>\n                <div class=\"news-card__date-div\">\n                <div class=\"news-card__date\">${new Date(\n                  pub_date\n                ).toLocaleDateString()}</div>\n                <button class=\"btn-read-more news-card__read-more\">\n                <ahref=\"${web_url}\" target=\"_blank\">Read more</ahref=>\n                </button>\n                </div>\n              </div>\n            </div>\n          `;\n}\n\n"],"names":["$bpxeT","parcelRequire","$3791646d3ae2cee8$var$API_KEY","$3791646d3ae2cee8$var$URL_SEARCH","$3791646d3ae2cee8$var$STOR_KEY","$3791646d3ae2cee8$export$e3bacd4ba36e1f7c","event","button","target","newsId","dataset","textContent","includes","classList","add","$3791646d3ae2cee8$var$_addNewsToLocalStorage","apply","this","arguments","$3791646d3ae2cee8$var$addNewsToLocalStorage","console","log","remove","currentData","$3791646d3ae2cee8$export$b366658078313913","newsIndex","findIndex","news","_id","splice","$3791646d3ae2cee8$var$saveToStorage","$3791646d3ae2cee8$var$deleteNewsFromLocalStorage","$parcel$interopDefault","$2TvXO","mark","_callee","data","section_name","abstract","pub_date","web_url","title","photoUrl","newsObject","$3791646d3ae2cee8$var$getFavoriteNews","_ctx","sent","response","docs","headline","main","multimedia","length","concat","url","undefined","push","key","value","JSON","stringify","localStorage","setItem","error","localData","getItem","parse","query","$3791646d3ae2cee8$var$_getFavoriteNews","fetch","then","resp","json","t0","$6befdf793f7dd1b0$var$placeForFavNews","document","getElementById","$6befdf793f7dd1b0$var$createFavoritePage","markup","innerHTML","forEach","substring","Date","toLocaleDateString","$6befdf793f7dd1b0$var$createFavoriteNewsCard","insertAdjacentHTML","addEventListener","closest"],"version":3,"file":"favorite.8ae36f6f.js.map"}